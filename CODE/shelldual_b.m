function [y, g] = shelldual_b(x)
% 
% Nonsmooth SHELL DUAL function
% Matlab Code by G.Liuzzi (October 4, 2017).
% The number of variables n should be adjusted below.
% The default value of n = 2.
% 
A = [-16.0  2.0  0.0  1.0  0.0;
       0.0 -2.0  0.0  4.0  2.0;
      -3.5  0.0  2.0  0.0  0.0;
       0.0 -2.0  0.0 -4.0 -1.0;
       0.0 -9.0 -2.0  1.0 -2.8;
       2.0  0.0 -4.0  0.0  0.0;
      -1.0 -1.0 -1.0 -1.0 -1.0;
      -1.0 -2.0 -3.0 -2.0 -1.0;
       1.0  2.0  3.0  4.0  5.0;
       1.0  1.0  1.0  1.0  1.0];
 
b = [-40.0; -2.0; -0.25; -4.0; -4.0; -1.0; -40.0; -60.0; 5.0; 1.0];

C = [ 30.0 -20.0 -10.0  32.0 -10.0;
     -20.0  39.0  -6.0 -31.0  32.0;
     -10.0  -6.0  10.0  -6.0 -10.0;
      32.0 -31.0  -6.0  39.0 -20.0;
     -10.0  32.0 -10.0 -20.0  30.0];
 
d = [4.0; 8.0; 10.0; 6.0; 2.0];

ee = [-15.0 -27.0 -36.0 -18.0 -12.0];

J10 = [1:10];
J5  = [1:5];

Q = sum(min(0,x));
P = A'*x(J10) - 2*C*x(J5+10) - 3*d.*x(J5+10).^2 - ee';
X = repmat(x(J5+10),1,5);

y = 2*abs(sum(d.*x(J5+10).^3)) + sum(sum(C.*X.*X')) - sum(b.*x(J10)) + 100*(sum(max(0,P)) - Q);

J = 1:(length(x)-2);
g = (3-2*x(J+1)).*x(J+1) - x(J) - 2*x(J+2) + 2.5;

end
